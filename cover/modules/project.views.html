<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <title>Test coverage report: project.views</title>
    <style type="text/css" media="screen">
      a
      {
        color: #3d707a;
      }
      
      a:hover, a:active
      {
        color: #bf7d18;
      }
    
      body 
      {
        font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
        font-size: 13px;
      }
      
      .nav 
      {
        font-size: 12px;
        margin-left: 50px;
      }

      .ignored
      {
        color: #707070;
      }

      .executed 
      {
        color: #3d9900;
      }

      .missed 
      {
        color: red;
        font-weight: bold;
      }

      .excluded 
      {
        color: #6090f0;
        font-weight: lighter;
      }
    
      #content-header 
      {
        font-size: 12px;
        padding: 18px 0 18px 50px;
      }

      #content-header h1 
      {
        font-size: 16px;
        margin: 10px 0 0 0;
        color: #909090;
      }
      
      #module-name
      {
        color: #583707;
      }
    
      #content-header p
      {
        font-size: 13px;
        margin: 0;
        color: #909090;
      }

      #content-header .normal 
      {
        color: #609030;
      }

      #content-header .warning 
      {
        color: #d0a000;
      }

      #content-header .critical 
      {
        color: red;
      }
      
      #source-listing 
      {
        margin-bottom: 24px;
      }

      #source-listing ol 
      {
        padding: 0 0 0 50px;
        width: 90%;
        font-family: monospace;
        list-style-position: outside;
      }

      #source-listing ol li 
      {
        line-height: 18px;
        font-size: small;
      }
        
      #source-listing ol code 
      {
        padding:  0 .001em 0 0; /* Firefox doesn't render empty li's properly */
        font-size: medium;
        white-space: pre;
      }
   </style>
  </head>

  <body>

<div class="nav">
  <a href="project.models.html">project.models</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="south.creator.actions.html">south.creator.actions</a>
</div>

<div id="content-header">
  <h1>
    <span id="module-name">project.views</span>:
    56 total statements,
    <span class="critical">27.9% covered</span>
  </h1>
  <p>Generated: Thu 2015-05-07 01:13 UTC</p>
  <p>Source file: /home/rita/Documents/task_manager/project/views.py</p>
  <p>
    Stats:
    <span class="executed">12 executed</span>,
    <span class="missed">31 missed</span>,
    <span class="excluded">13 excluded</span>,
    <span class="ignored">16 ignored</span> 
  </p> 
</div>

<div id="source-listing">
  <ol>
    <li class="ignored"><code>#-*-coding: utf-8 -*-</code></li>
<li class="excluded"><code>from django.core.context_processors import csrf</code></li>
<li class="excluded"><code>from django.contrib.auth.decorators import login_required</code></li>
<li class="excluded"><code>from task_manager.utils             import get_current_iterate</code></li>
<li class="excluded"><code>from django.shortcuts               import render_to_response, redirect</code></li>
<li class="excluded"><code>from django.http.response           import HttpResponse, Http404</code></li>
<li class="excluded"><code>from user_profile.models import UserProfile</code></li>
<li class="excluded"><code>from iteration.models  import Iteration</code></li>
<li class="excluded"><code>from task.models       import Task</code></li>
<li class="excluded"><code>from models            import Project</code></li>
<li class="excluded"><code>from forms             import ProjectForm</code></li>
<li class="excluded"><code>from django.core.cache import cache</code></li>
<li class="excluded"><code>from datetime          import datetime</code></li>
<li class="excluded"><code>import logging</code></li>
<li class="ignored"><code></code></li>
<li class="executed"><code>def edit_project(request, new = False):</code></li>
<li class="executed"><code>	if request.method == "POST":</code></li>
<li class="missed"><code>		if not new:</code></li>
<li class="missed"><code>			project = Project.objects.get(id = request.POST.get('project_id', cache.get('project_id')) )</code></li>
<li class="missed"><code>			form 	= ProjectForm(request.POST, request.FILES, instance = project)</code></li>
<li class="ignored"><code>		else:</code></li>
<li class="missed"><code>			form = ProjectForm(request.POST, request.FILES)</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>		if form.is_valid():</code></li>
<li class="missed"><code>			form.save()</code></li>
<li class="missed"><code>			return redirect(request.META.get('HTTP_REFERER','/'))</code></li>
<li class="ignored"><code>	else: # GET</code></li>
<li class="executed"><code>		args={}</code></li>
<li class="executed"><code>		args.update(csrf(request))</code></li>
<li class="ignored"><code></code></li>
<li class="executed"><code>		if 'project_id' in request.GET:</code></li>
<li class="missed"><code>			project_id = request.GET['project_id']</code></li>
<li class="missed"><code>			project = Project.objects.get(id = project_id)</code></li>
<li class="missed"><code>			args['form'] = ProjectForm(instance = project)</code></li>
<li class="missed"><code>			args['project'] = Project.objects.filter(id = project_id).values('id', 'title', 'text', 'leader__username', 'logo')[0]</code></li>
<li class="ignored"><code>		else:</code></li>
<li class="executed"><code>			args['form'] = ProjectForm()</code></li>
<li class="missed"><code>			args['new'] = '/new'</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>		return render_to_response('project_edit.html', args)</code></li>
<li class="ignored"><code></code></li>
<li class="executed"><code>@login_required(login_url='/auth')</code></li>
<li class="ignored"><code>def projects(request):</code></li>
<li class="executed"><code>	args = {}</code></li>
<li class="executed"><code>	args['projects'] = Project.objects.all().values('id', 'title', 'logo', 'text')</code></li>
<li class="executed"><code>	args['cache'] = { 'user_name' : cache.get('user_name') }</code></li>
<li class="ignored"><code></code></li>
<li class="executed"><code>	return render_to_response('projects.html', args)</code></li>
<li class="ignored"><code></code></li>
<li class="executed"><code>def show_project(request):</code></li>
<li class="missed"><code>	project_id = request.GET.get('project_id', cache.get('project_id'))</code></li>
<li class="missed"><code>	cur_iterate = cache.get('iterate_id')</code></li>
<li class="missed"><code>	if 'project_id' in request.GET:</code></li>
<li class="missed"><code>		project_id = request.GET['project_id']</code></li>
<li class="missed"><code>		if not project_id == cache.get('project_id'):</code></li>
<li class="missed"><code>			cur_iterate = get_current_iterate(project_id)</code></li>
<li class="missed"><code>			cache.set('iterate_id', cur_iterate)</code></li>
<li class="missed"><code>		cache.set('project_id', project_id)</code></li>
<li class="ignored"><code>	else:</code></li>
<li class="missed"><code>		project_id = cache.get('project_id')</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>	args = {}</code></li>
<li class="missed"><code>	args['project'] = Project.objects.filter(id = project_id).values('id', 'title', 'text', 'logo', 'leader__username', 'leader__id')[0]</code></li>
<li class="missed"><code>	cache.set('project_title', args['project']['title'])</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>	iterate = Iteration.objects.filter(id = cur_iterate)</code></li>
<li class="missed"><code>	args['iterate_title'] = iterate[0].title if iterate else 'Нет итерации'</code></li>
<li class="missed"><code>	args['new_tasks'] = Task.objects.filter(project = project_id).values('title', 'id', 'entrasted__username', 'assigned__username', 'type_task') .order_by('-updated')[0:5]</code></li>
<li class="ignored"><code></code></li>
<li class="missed"><code>	args['cache'] = { 'user_name' : cache.get('user_name') }</code></li>
<li class="missed"><code>	args['editor'] = True if (cache.get('user_id') == args['project']['leader__id'] or UserProfile.objects.filter(id = cache.get('user_id')).values('user__is_superuser')[0]['user__is_superuser']) else False</code></li>
<li class="missed"><code>	return render_to_response('project.html', args)</code></li>
  </ol>
</div>

<div class="nav">
  <a href="project.models.html">project.models</a> &lt;&lt;
  <a href="../index.html">index</a>
  &gt;&gt; <a href="south.creator.actions.html">south.creator.actions</a>
</div>

  </body>
</html>

